// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           String      @id @default(uuid())
  username     String      @unique
  passwordHash String
  createdAt    DateTime    @default(now())
  Character    Character?
}

model Character {
  id                String      @id @default(uuid())
  userId            String      @unique
  user              User        @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  name              String
  faction           Faction
  
  level             Int         @default(1)
  exp               Int         @default(0)
  berries           Int         @default(0)
  
  health            Int         @default(100)
  stamina           Int         @default(100)
  attack            Int         @default(10)
  defense           Int         @default(10)
  speed             Int         @default(10)
  
  hakiArmament      Int         @default(0)
  hakiObservation   Int         @default(0)
  hasConquerorsHaki Boolean     @default(false)
  
  mapRegion         String      @default("East Blue")
  x_coord           Int         @default(0)
  y_coord           Int         @default(0)
  
  devilFruit        DevilFruit?
  
  captainOf         Crew?       @relation("CaptainRelation")
  crewId            String?
  crew              Crew?       @relation("CrewMemberRelation", fields: [crewId], references: [id])
}

enum Faction {
  PIRATE
  MARINE
  BOUNTY_HUNTER
}

model DevilFruit {
  id            String      @id @default(uuid())
  name          String      @unique
  type          FruitType
  isEaten       Boolean     @default(false)
  
  ownerId       String?     @unique
  owner         Character?  @relation(fields: [ownerId], references: [id])
  
  spawnRegion   String?
  spawnX        Int?
  spawnY        Int?
}

enum FruitType {
  PARAMECIA
  ZOAN
  LOGIA
}

model Crew {
  id          String      @id @default(uuid())
  name        String      @unique
  
  captainId   String      @unique
  captain     Character   @relation("CaptainRelation", fields: [captainId], references: [id])
  
  members     Character[] @relation("CrewMemberRelation")
}
